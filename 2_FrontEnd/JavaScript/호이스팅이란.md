# 호이스팅이란?

자바스크립트에서 함수가 실행되어 Stack에 쌓이게 되면 해당 함수에 대한 실행 컨텍스트라는 것이 생성된다. 이러한 실행 컨텍스트는 함수의 시작과 끝을 함께하며 함수가 실행되는 데에 필요한 정보들을 저장하고 있게 된다. 이렇게 실행 컨텍스트가 생성되는 과정에서 함수 내부의 호이스팅이라는 것이 발생하는데, 이번에는 이 호이스팅이라는 것에 대해 공부해본 내용을 정리한다.

---

함수가 실행되고 실행 컨택스트가 생성되면 함수의 매개변수 식별자, 함수내 선언 함수, 함수내 선언 식별자 등에 대해 호이스팅이 발생하게 된다. 호이스팅은 함수 내의 코드들이 실행되기 이전에 앞서 언근한 식별자, 함수 등에 대한 정보를 미리 수집하여 `environmentRecord`라는 곳에 저장하는 과정을 의미한다. 즉, 실행 컨텍스트는 함수의 실제 코드가 실행되기 전부터 함수에서 활용될 여러 정보들을 미리 수집해 놓게 된다. 

다음 코드를 예로 들어보자

    function test(x){
        console.log(x);
        var x;
        console.log(x);
        var x = 2;
        console.log(x);
    }

    test(1);

위 함수의 실행결과는 `1, undefined, 2`가 아닌, `1, 1, 2`가 출력 된다. 이 코드를 호이스팅이 되는 순서로 변경하게 되면 다음과 같이 표현할 수 있다.

    function test(){
        var x; // 매개변수 식별자 저장
        var x; // 첫번째 지역변수 식별자 저장
        var x; // 두번째 지역변수 식별자 저장

        x = 1 // 매개변수 값 할당
        console.log(x); // 첫번째 로그
        console.log(x); // 두번째 로그
        x = 2 // 지역변수 값 할당
        console.log(x); // 세번째 로그 
    }

즉 함수 내부의 코드가 실행되기 전에 매개변수 식별자 및 지역변수 식별자를 이미 수집해 놓은 상태이다. 그렇기 때문에 같은 이름의 식별자를 코드 중간중간 여러변 선언한다고 할지라도 새로 값을 지정해주지 않는한 이전에 같은 이름으로 선언되어있던 변수의 값이 그대로 출력되는 것이다.

이번에는 함수를 포함한 경우를 살펴보자

    function test(){
        console.log(b);
        var b = 1;
        console.log(b);
        function b(){}
        console.lob(b);
    }

위 실행결과는 어떨까? 앞서 호이스팅되는 순서와 일치하게 코드를 수정하면 다음과 같아진다.

    function test(){
        var b;
        function b(){}

        console.log(b); // 함수 b 출력
        b = 1;
        console.log(b); // 1 출력
        console.log(b); // 1 출력
    }

만약 호이스팅의 개념을 몰랐다면, `undefined, 1, 함수 b`순서로 출력을 기대했을 것이다. 그러나 실제 결과는 `함수 b, 1, 1`이라는 전혀 다른 결과가 나온다. 

이 예제를 통해 어떻게 자바스크립트에서는 함수가 실제 선언된 코드부분이 실행되기 전에 함수를 호출해도 잘 작동하는지 그 이유를 확인할 수 있다.

