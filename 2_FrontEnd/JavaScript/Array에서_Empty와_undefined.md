# Array에서 Empty와 undefined

흔하지는 않지만, 가끔은 자바스크립트에서 배열의 객체를 생성할때 미리 배열의 길이를 지정해놓는 경우가 종종있다. 

    const arr = new Array(10);

처음 이런식으로 배열을 생성한 후에는 당연 10개의 공간이 생성되었으니 각각의 인덱스에는 undefined가 들어가 있으리라 생각했다. 그러나 실제 배열을 클릭하면 다음과 같이 출력된다.

    [empty × 10]

보통 할당되지 않은 변수, 값을 undefined라고 생각하기 때문에 이 경우에도 undefined로 정의되어 있으리라 생각했지만, 전혀 본적없는 empty x 10 이라는 다소 이상한 표현으로 출력되는 것에 어떤 내용인가 궁금해 찾아보았다.

관련 내용은 최근 구매한 정재남님의 코어자바스크립트에서 자세한 내용을 찾을 수 있었다. 

---

우리가 자바스크립트에서 식별자를 통해 변수를 생성하게 되면 메모리상에는 생성한 변수의 데이터 타입에 맞는 별도의 메모리 공간과 더불어 식별자와 실제 데이터의 메모리 주소를 저장하고 있는 메모리 공간을 확보하게 된다. 

이러한 [식별자 & 메모리주소값 , 실제 데이터 메모리]의 두 메모리 공간은 해당 변수가 객체일 경우 객체 내부에 있는 프로퍼티값들에도 동일한 방식으로 생성된다.

예를 들어, 다음과 같은 객체가 있다고 가정하자.

    const obj = {
        a : 1,
        b : 2
    }

이 경우, `obj`라는 객체가 생성되면서 객체 자체에 대한 메모리 공간이 확보된다. 이후 생성된 메모리 공간에 대한 주소값은 `obj`라는 식별자와 함께 또 다른 메모리 공간에 저장되게 되며, `obj`라는 변수를 사용해야 할 경우 대략 `obj -> 메모리주소 -> 실제데이터접근` 의 순서를 거쳐 실제 데이터를 조회하게 된다. 

그렇다면 obj안에 정의된 `a`와 `b` 프로퍼티 값들은 어떨까? 이 역시 앞서 obj가 정의되었던 방식과 마찬가지의 형태로 메모리에 저장되게 된다. 다만, 각각의 식별자와 값에 대한 메모리 주소가`obj`의 데이터 메모리에 저장될 뿐이다. 즉, `obj`객체 안에 `a`라는 프로퍼티에 접근하기 위해서는 `obj -> 메모리주소 -> obj데이터 접근 -> 프로퍼티 a 식별자 탐색 -> 프로퍼티 a의 데이터 메모리 주소 -> a의 실제 데이터 접근`의 형태로 `a`에 접근하게 되는 것이다. 

다시 Array로 돌아와보자. Array에서 각 자리에 해당하는 index는 Array의 해당 index에 값이 지정되고 나서야 비로소 프로퍼티로서의 성격을 갖게 된다. 즉, `new Array(10)`를 통해 배열내부에 10개의 공간을 확보하였을지라도 각 자리수에 해당하는 index는 아직 정의되지 않은 프로퍼티일 뿐이다.


    const arr = new Array(10) // [ Empty x 10 ]
    arr[0] === undefined      // true

즉, 10개의 자리를 확보한 Array는 10개의 빈 공간을 가지고 있다(Empty x 10). 그러나 이러한 빈 공간에 `undefined`가 할당된다는 것은 그 자체로 아무것도 없는 빈 공간이 아닌게 되어버린다. 왜냐하면, `undefined`가 할당됨으로써 배열의 각 index에 해당하는 프로퍼티가 생성되고 `undefined`는 해당 프로퍼티의 값이 할당되지 않는 상태라는 값이 되기 때문이다. 

다소 말장난같은 이야기이긴 하지만, 자바스크립트에서 변수가 실제로 메모리상에 어떻게 저장이 되는지에 대해 이해하고 나니 이러한 차이가 크게 느껴지는 것 같다.

이러한 차이를 이해하고 나면 다음의 결과도 이해할 수 있다.

    const arr1 = new Array(10);
    const arr2 = new Array(10).fill(10);

    arr1.forEach(i => console.log(i));  // 출력되지 않음
    arr2.forEach(i => console.log(i)); // undefined 10번 출력

배열의 프로퍼티에 해당하는 각 인덱스에 해당하는 값을 순회하는 forEach에서 arr1에 해당하는 값이 아무것도 출력되지 않는것은 arr1에는 10개의 데이터 공간이 확보되어있기는 하지만, 아무런 프로퍼티(index)도 정의되어있지 않은 상태이기 때문이다. 

만약 arr1을 다음과 같이 변경하면 어떻게 될까?

    arr1[9] = 1;

이 경우 forEach를 통한 출력의 결과는 다음과 같을 것이다.

    arr1.forEach((el, i)=> console.log(el,i));
    // 1, 9 출력

즉, 9번째 index에 해당하는 값만 값이 할당되어 정의되었기 때문에 forEach가 순회하는 프로퍼티의 대상은 9번째 index가 유일한 것이다.

이렇게 대략(?)적으로 Array에서의 Empty와 undefined의 차이가 무엇인지에 대해 정리해 보았다. 이 개념을 하나 학습하는데에도 꽤 많은 기초 지식이 필요하다는 것에 한번 더 기초의 중요성을 깨닫게 되었다. 